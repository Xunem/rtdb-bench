!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s=6)}([function(t,e,r){var n=r(4),o=r(5),i=o;i.v1=n,i.v4=o,t.exports=i},function(t,e){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);t.exports=function(){return r(n),n}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},function(t,e){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,o=r;return[o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]]].join("")}},,function(t,e,r){var n,o,i=r(1),s=r(2),a=0,c=0;t.exports=function(t,e,r){var u=e&&r||0,l=e||[],h=(t=t||{}).node||n,f=void 0!==t.clockseq?t.clockseq:o;if(null==h||null==f){var p=i();null==h&&(h=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=o=16383&(p[6]<<8|p[7]))}var d=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:c+1,b=d-a+(v-c)/1e4;if(b<0&&void 0===t.clockseq&&(f=f+1&16383),(b<0||d>a)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=d,c=v,o=f;var y=(1e4*(268435455&(d+=122192928e5))+v)%4294967296;l[u++]=y>>>24&255,l[u++]=y>>>16&255,l[u++]=y>>>8&255,l[u++]=255&y;var m=d/4294967296*1e4&268435455;l[u++]=m>>>8&255,l[u++]=255&m,l[u++]=m>>>24&15|16,l[u++]=m>>>16&255,l[u++]=f>>>8|128,l[u++]=255&f;for(var w=0;w<6;++w)l[u+w]=h[w];return e||s(l)}},function(t,e,r){var n=r(1),o=r(2);t.exports=function(t,e,r){var i=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[i+a]=s[a];return e||o(s)}},function(t,e,r){"use strict";r.r(e);var n=new Promise(function(t){firebase.initializeApp({apiKey:"AIzaSyAutXeruAGoGxOSuTQSxBH-iVxHoN9K56k",authDomain:"fir-demo-aa3d1.firebaseapp.com",databaseURL:"https://fir-demo-aa3d1.firebaseio.com",projectId:"fir-demo-aa3d1",storageBucket:"fir-demo-aa3d1.appspot.com",messagingSenderId:"801259432549"}),DB.connect("real-time-benchmark"),DB.ready().then(function(){t(!0)})}),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function i(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function s(t){return"function"==typeof t}var a=!1,c={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;a=t},get useDeprecatedSynchronousErrorHandling(){return a}};function u(t){setTimeout(function(){throw t})}var l={closed:!0,next:function(t){},error:function(t){if(c.useDeprecatedSynchronousErrorHandling)throw t;u(t)},complete:function(){}},h=Array.isArray||function(t){return t&&"number"==typeof t.length};function f(t){return null!=t&&"object"==typeof t}var p,d={e:{}};function v(){try{return p.apply(this,arguments)}catch(t){return d.e=t,d}}function b(t){return p=t,v}function y(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}y.prototype=Object.create(Error.prototype);var m=y,w=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,n=this._parents,o=this._unsubscribe,i=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var a=-1,c=n?n.length:0;r;)r.remove(this),r=++a<c&&n[a]||null;if(s(o))b(o).call(this)===d&&(e=!0,t=t||(d.e instanceof m?g(d.e.errors):[d.e]));if(h(i))for(a=-1,c=i.length;++a<c;){var u=i[a];if(f(u))if(b(u.unsubscribe).call(u)===d){e=!0,t=t||[];var l=d.e;l instanceof m?t=t.concat(g(l.errors)):t.push(l)}}if(e)throw new m(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function g(t){return t.reduce(function(t,e){return t.concat(e instanceof m?e.errors:e)},[])}var x="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("rxSubscriber"):"@@rxSubscriber",_=function(t){function e(e,r,n){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,o._parentSubscription=null,arguments.length){case 0:o.destination=l;break;case 1:if(!e){o.destination=l;break}if("object"==typeof e){if(function(t){return t instanceof _||"_addParentTeardownLogic"in t&&t[x]}(e)){var i=e[x]();o.syncErrorThrowable=i.syncErrorThrowable,o.destination=i,i._addParentTeardownLogic(o)}else o.syncErrorThrowable=!0,o.destination=new S(o,e);break}default:o.syncErrorThrowable=!0,o.destination=new S(o,e,r,n)}return o}return i(e,t),e.prototype[x]=function(){return this},e.create=function(t,r,n){var o=new e(t,r,n);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t),this._unsubscribeParentSubscription())},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete(),this._unsubscribeParentSubscription())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._addParentTeardownLogic=function(t){t!==this&&(this._parentSubscription=this.add(t))},e.prototype._unsubscribeParentSubscription=function(){null!==this._parentSubscription&&this._parentSubscription.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},e}(w),S=function(t){function e(e,r,n,o){var i,a=t.call(this)||this;a._parentSubscriber=e;var c=a;return s(r)?i=r:r&&(i=r.next,n=r.error,o=r.complete,r!==l&&(s((c=Object.create(r)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=i,a._error=n,a._complete=o,a}return i(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=c.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):u(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;u(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),c.useDeprecatedSynchronousErrorHandling)throw t;u(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!c.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return c.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(u(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(_);var E="function"==typeof Symbol&&Symbol.observable||"@@observable";function M(){}function k(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:M}var T=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,o=function(t,e,r){if(t){if(t instanceof _)return t;if(t[x])return t[x]()}return t||e||r?new _(t,e,r):new _(l)}(t,e,r);if(n?n.call(o,this.source):o._addParentTeardownLogic(this.source||c.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),c.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){c.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=D(e))(function(e,n){var o;o=r.subscribe(function(e){try{t(e)}catch(t){n(t),o&&o.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[E]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:k(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=D(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function D(t){if(t||(t=c.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function P(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var O=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};var j=function(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();var C=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.closed||e.complete()}};var I=function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,u),e}};var A=function(t){return function(e){for(var r=t[j]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add(function(){r.return&&r.return()}),e}};var B=function(t){return function(e){var r=t[E]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(e)}};var H=function(t){if(t instanceof T)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[E])return B(t);if(O(t))return C(t);if(P(t))return I(t);if(t&&"function"==typeof t[j])return A(t);var e=f(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function L(t,e){if(!e)return t instanceof T?t:new T(H(t));if(null!=t){if(function(t){return t&&"function"==typeof t[E]}(t))return function(t,e){return new T(e?function(r){var n=new w;return n.add(e.schedule(function(){var o=t[E]();n.add(o.subscribe({next:function(t){n.add(e.schedule(function(){return r.next(t)}))},error:function(t){n.add(e.schedule(function(){return r.error(t)}))},complete:function(){n.add(e.schedule(function(){return r.complete()}))}}))})),n}:B(t))}(t,e);if(P(t))return function(t,e){return new T(e?function(r){var n=new w;return n.add(e.schedule(function(){return t.then(function(t){n.add(e.schedule(function(){r.next(t),n.add(e.schedule(function(){return r.complete()}))}))},function(t){n.add(e.schedule(function(){return r.error(t)}))})})),n}:I(t))}(t,e);if(O(t))return function(t,e){return new T(e?function(r){var n=new w,o=0;return n.add(e.schedule(function(){o!==t.length?(r.next(t[o++]),r.closed||n.add(this.schedule())):r.complete()})),n}:C(t))}(t,e);if(function(t){return t&&"function"==typeof t[j]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new T(e?function(r){var n,o=new w;return o.add(function(){n&&"function"==typeof n.return&&n.return()}),o.add(e.schedule(function(){n=t[j](),o.add(e.schedule(function(){if(!r.closed){var t,e;try{var o=n.next();t=o.value,e=o.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}}))})),o}:A(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var q=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new R(t,this.project,this.thisArg))},t}(),R=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return i(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(_);function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function V(t,e,r){return e&&N(t.prototype,e),r&&N(t,r),t}var Y=0,U=1,J=10,W=40,z=70,K=80,X=function(){function t(e,r,n){switch(Q(this,t),e){case U:this.dbprov=new G;break;case Y:this.dbprov=new F(r,n)}}return V(t,[{key:"saveData",value:function(t){this.dbprov.saveData(t)}},{key:"doQuery",value:function(){return this.dbprov.doQuery()}},{key:"updateQuery",value:function(t){return this.dbprov.updateQuery(t)}}]),t}(),G=function(){function t(){Q(this,t)}return V(t,[{key:"saveData",value:function(){}}]),t}(),F=function(){function t(e,r){Q(this,t),this.queryType=e,this.details=r,this.setQuery()}return V(t,[{key:"setQuery",value:function(){switch(this.queryType){case J:this.query=DB.ServerData.find().descending("ts").limit(40);break;case 20:case 30:this.query=DB.SensorData.find();break;case W:this.query=DB.ServerData.find().equal("serverroom",this.details.room).descending("ts").limit(20);break;case z:this.query=DB.ServerData.find().equal("sid",this.details.serverid).descending("ts").limit(this.details.limit);break;case 50:case 60:this.query=DB.SensorData.find();break;default:this.query=DB.SensorData.find()}}},{key:"doQuery",value:function(){return this.subscription=L(this.query.eventStream()).pipe(function(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new q(t,e))}}(function(t){return"add"===t.matchType?{matchType:"add",data:t.data}:"remove"===t.matchType?{matchType:"remove",data:t.data}:void 0})),this.subscription}},{key:"updateQuery",value:function(t){return this.details=t,this.setQuery(),this.doQuery()}},{key:"saveData",value:function(t){new DB.ServerData({mid:t.mid,sid:t.sid,serverroom:t.room,rack:t.rack,unit:t.unit,os:t.os,temp:t.temp,cpu:t.cpu,ts:t.ts}).save()}}]),t}(),Z=r(0);function $(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var tt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.firebaseClient=new X(U,K,{}),this.baqendClient=new X(Y,K,{}),this.insertRate=e,this.servers=[],this.serverCount,this.counter=0}return function(t,e,r){e&&$(t.prototype,e),r&&$(t,r)}(t,[{key:"setup",value:function(){console.log("init");var t={0:"freebsd",1:"ubuntu",2:"windows Server 2012",3:"windows Server 2016"},e=0,r=0;this.serverCount=40;for(var n=0;n<this.serverCount;n++){var o={};o.mid=Object(Z.v4)(),o.os=t[e],o.rack=r,o.unit=n%5,n<this.serverCount/2?o.room=1:o.room=2,o.sid="r"+o.room+"r"+o.rack+"u"+o.unit,(n+1)%4==0&&(e=(e+1)%4),(n+1)%5==0&&(r=(r+1)%4);var i=Math.random();o.temp=40*i+25,o.cpu=50*i+50,o.ts=Date.now(),this.servers.push(o),this.firebaseClient.saveData(o),this.baqendClient.saveData(o)}}},{key:"start",value:function(){var t=this;this.refreshIntervalId=setInterval(function(){for(var e=0;e<t.insertRate;e++){var r=t.servers[t.counter],n={mid:Object(Z.v4)(),sid:r.sid,room:r.room,rack:r.rack,unit:r.unit,os:r.os},o=100*Math.random(),i=Math.floor(o)%2;r.temp=o<80?0==i?Math.min(r.temp+o/100,90):Math.max(r.temp-o/100,25):0==i?Math.min(r.temp+o%10,90):Math.max(r.temp-o%10,25),n.temp=r.temp,n.cpu=r.cpu,n.ts=Date.now(),console.log(JSON.stringify(n)),t.counter=(t.counter+1)%t.serverCount,t.firebaseClient.saveData(n),t.baqendClient.saveData(n)}},1e3)}},{key:"stop",value:function(){clearInterval(this.refreshIntervalId)}}]),t}();function et(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var nt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.controls=e,this.serverData=new Map,this.Dbinterface=new X(Y,J,{})}return function(t,e,r){e&&rt(t.prototype,e),r&&rt(t,r)}(t,[{key:"init",value:function(){var t=this;this.anctx=document.getElementById("ov_ba_cvs").getContext("2d"),this.subscription=this.Dbinterface.doQuery().subscribe(function(e){return t.handleEvent(e)},function(t){return console.log("onError: %s",JSON.stringify(t))},function(){return console.log("onCompleted")}),this.redraw()}},{key:"redraw",value:function(){this.anctx.clearRect(0,0,this.anctx.canvas.width,this.anctx.canvas.height)}},{key:"handleEvent",value:function(t){switch(t.matchType){case"add":this.add(t.data);break;case"remove":this.remove(t.data.mid);break;default:console.log("Wrong Eventtype")}}},{key:"add",value:function(t){this.serverData.set(t.mid,t),this.redraw(),this.calcHottest()}},{key:"remove",value:function(t){this.serverData.delete(t),this.redraw()}},{key:"calcHottest",value:function(){for(var t=Array.from(this.serverData,function(t){var e=et(t,2);e[0];return e[1]}),e=0,r="",n=0;n<t.length;n++)t[n].temp>e&&(e=t[n].temp,r=t[n].sid);this.controls.getHottestServer().next(r)}}]),t}();function ot(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var st=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.controls=e,this.racks=5,this.units=10,this.hover="",this.serverData=new Map,this.serverDisplay=new Map,this.initial=!0,this.room="",e.getRoomNumber().subscribe(function(t){r.room=t,r.setDetails(),r.initial?(r.Dbinterface=new X(Y,W,{room:parseInt(t)}),r.subscription=r.Dbinterface.doQuery().subscribe(function(t){return r.handleEvent(t)},function(t){return console.log("onError: %s",JSON.stringify(t))},function(){return console.log("onCompleted")}),r.initial=!1):(r.subscription.unsubscribe(),r.serverData=new Map,console.log(t),r.subscription=r.Dbinterface.updateQuery({room:parseInt(t)}).subscribe(function(t){return r.handleEvent(t)},function(t){return console.log("onError: %s",JSON.stringify(t))},function(){return console.log("onCompleted")}))})}return function(t,e,r){e&&it(t.prototype,e),r&&it(t,r)}(t,[{key:"init",value:function(){var t=this,e=document.getElementById("rm_ba_cvs");this.anctx=e.getContext("2d"),this.toolTip=document.getElementById("ToolTip"),this.redraw(),e.addEventListener("mousemove",function(r){var n=e.getBoundingClientRect(),o=t.anctx.canvas.width,i=t.anctx.canvas.height,s=Math.floor((i-60)/t.units),a=Math.floor((o-20)/t.racks),c=r.clientX-n.left,u=r.clientY-n.top,l=30+Math.floor(.2*s),h=30+Math.floor(.2*s)+5*s;if(u>l&&u<h&&(c>10+0*Math.floor(a)+Math.floor(.1*a)&&c<10+0*Math.floor(a)+Math.floor(.1*a)+Math.floor(.8*a)||c>10+1*Math.floor(a)+Math.floor(.1*a)&&c<10+1*Math.floor(a)+Math.floor(.1*a)+Math.floor(.8*a)||c>10+2*Math.floor(a)+Math.floor(.1*a)&&c<10+2*Math.floor(a)+Math.floor(.1*a)+Math.floor(.8*a)||c>10+3*Math.floor(a)+Math.floor(.1*a)&&c<10+3*Math.floor(a)+Math.floor(.1*a)+Math.floor(.8*a)||c>10+4*Math.floor(a)+Math.floor(.1*a)&&c<10+4*Math.floor(a)+Math.floor(.1*a)+Math.floor(.8*a))){var f=Math.floor((c-10)/a),p=Math.floor((u-l)/s);t.hover="r"+t.room+"r"+f+"u"+p,e.style.cursor="pointer";var d=t.serverDisplay.get(t.hover);t.toolTip.style.top=r.pageY-10+"px",t.toolTip.style.left=r.pageX+20+"px",t.toolTip.innerHTML=t.hover+"<br>Temp: "+Math.floor(d.temp)+"Â°C<br>CPU: "+Math.floor(d.cpu)+"%",t.toolTip.style.display="block"}else t.hover="",t.toolTip.style.display="none",e.style.cursor="auto";t.redraw()}),e.addEventListener("click",function(e){t.hover&&t.controls.getServerId().next(t.hover)}),e.addEventListener("mouseout",function(){t.hover="",t.toolTip.style.display="none",e.style.cursor="auto",t.redraw()})}},{key:"redraw",value:function(){this.anctx.clearRect(0,0,this.anctx.canvas.width,this.anctx.canvas.height);for(var t=this.anctx.canvas.width,e=this.anctx.canvas.height,r=Math.floor((e-60)/this.units),n=Math.floor((t-20)/this.racks),o=0;o<this.racks;o++){for(var i=0;i<this.units;i++)this.anctx.beginPath(),this.anctx.moveTo(10+Math.floor(n)*o,30+r*i),this.anctx.lineTo(10+Math.floor(n)*o,30+r*(i+1)),this.anctx.lineTo(10+Math.floor(.1*n)+Math.floor(n)*o,30+r*(i+1)+Math.floor(.2*r)),this.anctx.lineTo(10+n*o+Math.floor(.9*n),30+r*(i+1)+Math.floor(.2*r)),this.anctx.stroke();this.anctx.lineTo(10+n*o+Math.floor(.9*n),30+Math.floor(.2*r)),this.anctx.lineTo(10+n*o+Math.floor(.9*n)-Math.floor(.1*n),30),this.anctx.lineTo(10+Math.floor(n)*o,30),this.anctx.fillStyle="rgba(198, 198, 198, 0.7)",this.anctx.fill(),this.anctx.stroke(),this.anctx.lineTo(10+Math.floor(.1*n)+Math.floor(n)*o,30+Math.floor(.2*r)),this.anctx.stroke()}for(var s=Array.from(this.serverData,function(t){var e=ot(t,2);e[0];return e[1]}),a=0;a<s.length;a++){this.hover===s[a].sid?this.anctx.fillStyle="RED":this.anctx.fillStyle="#E1E1E1",this.anctx.beginPath(),this.anctx.strokeStyle="BLACK";var c=10+Math.floor(n)*s[a].rack+Math.floor(.1*n),u=30+r*s[a].unit+Math.floor(.2*r),l=Math.floor(.8*n),h=r;this.anctx.rect(c,u,l,h),this.anctx.fill(),this.anctx.stroke(),this.anctx.beginPath(),this.anctx.rect(c+Math.floor(.25*l),u+Math.floor(.25*h),Math.floor(.25*l),Math.floor(.5*h));var f=65,p=s[a].temp-25;if(p>f/2){var d=(p-=f/2)/(f/2),v="rgb(255,"+(255-Math.floor(255*d))+",0)";this.anctx.fillStyle=v}else{var b=p/(f/2),y="rgb("+Math.floor(255*b)+",255,0)";this.anctx.fillStyle=y}if(this.anctx.fill(),this.anctx.stroke(),this.anctx.beginPath(),this.anctx.rect(c+Math.floor(.5*l),u+Math.floor(.25*h),Math.floor(.25*l),Math.floor(.5*h)),f=50,(p=s[a].cpu-50)>f/2){var m=(p-=f/2)/(f/2),w="rgb(255,"+(255-Math.floor(255*m))+",0)";this.anctx.fillStyle=w}else{var g=p/(f/2),x="rgb("+Math.floor(255*g)+",255,0)";this.anctx.fillStyle=x}this.anctx.fill(),this.anctx.stroke()}}},{key:"handleEvent",value:function(t){switch(t.matchType){case"add":this.add(t.data);break;case"remove":this.remove(t.data.mid);break;default:console.log("Wrong Eventtype")}}},{key:"add",value:function(t){this.serverDisplay.set(t.sid,{cpu:t.cpu,temp:t.temp}),this.serverData.set(t.mid,t),this.redraw()}},{key:"remove",value:function(t){this.serverData.delete(t),this.redraw()}},{key:"setDetails",value:function(){document.getElementById("room_details").innerHTML="Room "+this.room}}]),t}();function at(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ut=function(){function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.controls=e,this.initial=!0,this.serverid=r,this.limit=25,this.serverData=new Map,this.temp={},e.getServerId().subscribe(function(t){t&&(n.serverid=t,n.setDetails(),n.initial?(n.Dbinterface=new X(Y,z,{serverid:n.serverid,limit:n.limit}),n.subscription=n.Dbinterface.doQuery().subscribe(function(t){return n.handleEvent(t)},function(t){return console.log("onError: %s",JSON.stringify(t))},function(){return console.log("onCompleted")}),n.initial=!1):(n.subscription.unsubscribe(),n.serverData=new Map,n.subscription=n.Dbinterface.updateQuery({serverid:n.serverid,limit:n.limit}).subscribe(function(t){return n.handleEvent(t)},function(t){return console.log("onError: %s",JSON.stringify(t))},function(){return console.log("onCompleted")})))})}return function(t,e,r){e&&ct(t.prototype,e),r&&ct(t,r)}(t,[{key:"init",value:function(){this.anctx=document.getElementById("srv_ba_cvs").getContext("2d"),this.redraw()}},{key:"redraw",value:function(){this.anctx.clearRect(0,0,this.anctx.canvas.width,this.anctx.canvas.height);var t=Array.from(this.serverData,function(t){var e=at(t,2);e[0];return e[1]}),e=this.anctx.canvas.width,r=this.anctx.canvas.height,n=Math.floor((e-20)/(this.limit-1));t.sort(function(t,e){return e.ts-t.ts}),this.anctx.beginPath(),this.anctx.moveTo(0,75),this.anctx.lineTo(e,75),this.anctx.lineWidth=1,this.anctx.strokeStyle="#bababa",this.anctx.stroke(),this.anctx.beginPath(),this.anctx.moveTo(0,150),this.anctx.lineTo(e,150),this.anctx.stroke(),this.anctx.beginPath(),this.anctx.moveTo(0,225),this.anctx.lineTo(e,225),this.anctx.stroke();for(var o=0;o<t.length;o++)o>0&&(this.anctx.beginPath(),this.anctx.moveTo(e-10-(o-1)*n,r-3*Math.floor(t[o-1].temp)),this.anctx.lineWidth=2,this.anctx.strokeStyle="#ff9d00",this.anctx.lineTo(e-10-o*n,r-3*Math.floor(t[o].temp)),this.anctx.stroke(),this.anctx.beginPath(),this.anctx.moveTo(e-10-(o-1)*n,r-3*Math.floor(t[o-1].cpu)),this.anctx.lineWidth=2,this.anctx.strokeStyle="#0007d3",this.anctx.lineTo(e-10-o*n,r-3*Math.floor(t[o].cpu)),this.anctx.stroke()),this.anctx.beginPath(),this.anctx.arc(e-10-o*n,r-3*Math.floor(t[o].temp),4,0,2*Math.PI),this.anctx.strokeStyle="#ff9d00",this.anctx.fillStyle="#ff9d00",this.anctx.fill(),this.anctx.stroke(),this.anctx.beginPath(),this.anctx.arc(e-10-o*n,r-3*Math.floor(t[o].cpu),4,0,2*Math.PI),this.anctx.strokeStyle="#0007d3",this.anctx.fillStyle="#0007d3",this.anctx.fill(),this.anctx.stroke()}},{key:"handleEvent",value:function(t){switch(t.matchType){case"add":this.add(t.data);break;case"remove":this.remove(t.data.mid);break;default:console.log("Wrong Eventtype")}}},{key:"add",value:function(t){this.serverData.set(t.mid,t),this.redraw()}},{key:"remove",value:function(t){this.serverData.delete(t),console.log(this.serverData),this.redraw()}},{key:"setDetails",value:function(){document.getElementById("server_details").innerHTML="Server "+this.serverid}}]),t}();function lt(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}lt.prototype=Object.create(Error.prototype);var ht=lt,ft=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return i(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(w),pt=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return i(e,t),e}(_),dt=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return i(e,t),e.prototype[x]=function(){return new pt(this)},e.prototype.lift=function(t){var e=new vt(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new ht;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new ht;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new ht;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new ht;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new ht;return this.hasError?(t.error(this.thrownError),w.EMPTY):this.isStopped?(t.complete(),w.EMPTY):(this.observers.push(t),new ft(this,t))},e.prototype.asObservable=function(){var t=new T;return t.source=this,t},e.create=function(t,e){return new vt(t,e)},e}(T),vt=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return i(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):w.EMPTY},e}(dt),bt=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return i(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ht;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(dt);function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hottestServer=new bt,this.hottestServer.next(!0),this.roomNumber=new bt,this.roomNumber.next(1),this.serverId=new bt,this.serverLimit=new bt,this.serverLimit.next(15)}return function(t,e,r){e&&yt(t.prototype,e),r&&yt(t,r)}(t,[{key:"getLimit",value:function(){return this.serverLimit}},{key:"getServerId",value:function(){return this.serverId}},{key:"getHottestServer",value:function(){return this.hottestServer}},{key:"getRoomNumber",value:function(){return this.roomNumber}}]),t}(),wt=1;n.then(function(t){var e=new mt,r=new tt(3),n=new nt(e),o=new st(e,1),i=new ut(e,"r2r2u0");n.init(),o.init(),i.init(),document.getElementById("init").addEventListener("click",function(){r.setup()}),document.getElementById("start").addEventListener("click",function(){r.start()}),document.getElementById("stop").addEventListener("click",function(){r.stop()}),document.getElementById("hottest").checked=!0;var s=document.getElementById("room");s.addEventListener("change",function(){s.value!=wt&&(wt=s.value,e.getRoomNumber().next(wt))})})}]);